(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{40:function(e,t,a){e.exports=a(83)},45:function(e,t,a){},83:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(19),l=a.n(c),o=(a(45),a(2)),u=a(6),s=a(9),i=a(7),p=Object(n.createContext)(),m=Object(n.createContext)(),g=a(3),d=a.n(g),f=a(5),h=a(39),b=a(4),v=a.n(b),E=a(16);var y=function(e){var t=e.setRestaurants,a=e.setRestaurantCollection,c=e.restaurantCollection,l=e.setSortCount,u=Object(n.useState)(""),s=Object(o.a)(u,2),i=s[0],m=s[1],g=Object(n.useState)(""),h=Object(o.a)(g,2),b=h[0],y=h[1],j=Object(n.useState)(!1),O=Object(o.a)(j,2),x=O[0],w=O[1],C=Object(n.useContext)(p);function k(){return(k=Object(f.a)(d.a.mark((function e(n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),!i||!b){e.next=17;break}return e.prev=2,e.next=5,v.a.get("/api/restaurants/search?locationType=".concat(i,"&location=").concat(b));case 5:r=e.sent,t(r.data.slice(0,10)),a(r.data),y(""),w(!0),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),C({type:"FlashMessage",value:e.t0.response.data,color:"error"});case 15:e.next=18;break;case 17:C({type:"FlashMessage",value:"You cannot leave the fields blank.",color:"error"});case 18:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function S(){return(S=Object(f.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("/api/restaurants");case 3:n=e.sent,t(n.data.slice(0,10)),a(n.data),w(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),C({type:"FlashMessage",value:e.t0.response.data,color:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}return r.a.createElement(r.a.Fragment,null,"Sort by:",r.a.createElement("select",{onChange:function(e){var n;switch(e.currentTarget.value){case"highest-rated":n=Object(E.a)(c).sort((function(e,t){return t.rating-e.rating}));break;case"lowest-rated":n=Object(E.a)(c).sort((function(e,t){return e.rating-t.rating}));break;case"price-high-low":n=Object(E.a)(c).sort((function(e,t){return t.pricerange-e.pricerange}));break;case"price-low-high":n=Object(E.a)(c).sort((function(e,t){return e.pricerange-t.pricerange}));break;case"most-rated":n=Object(E.a)(c).sort((function(e,t){return t.count-e.count}));break;case"alphabetical-a-z":n=Object(E.a)(c).sort((function(e,t){return e.name.localeCompare(t.name)}));break;case"alphabetical-z-a":n=Object(E.a)(c).sort((function(e,t){return t.name.localeCompare(e.name)}));break;default:n=Object(E.a)(c)}t(n.slice(0,10)),a(n),l((function(e){return e+1}))},defaultValue:"Select..."},r.a.createElement("option",{disabled:!0,value:"Select..."},"Select..."),r.a.createElement("option",{value:"highest-rated"},"Highest Rated"),r.a.createElement("option",{value:"lowest-rated"},"Lowest Rated"),r.a.createElement("option",{value:"most-rated"},"Most Reviewed"),r.a.createElement("option",{value:"price-high-low"},"Price: High-Low"),r.a.createElement("option",{value:"price-low-high"},"Price: Low-High"),r.a.createElement("option",{value:"alphabetical-a-z"},"Alphabetical (A-Z)"),r.a.createElement("option",{value:"alphabetical-z-a"},"Alphabetical (Z-A)")),r.a.createElement("h5",null,"Search for businesses near you..."),r.a.createElement("form",{onSubmit:function(e){return k.apply(this,arguments)}},r.a.createElement("select",{onChange:function(e){return m(e.currentTarget.value)},defaultValue:"Search by..."},r.a.createElement("option",{disabled:!0},"Search by..."),r.a.createElement("option",{value:"street"},"Street"),r.a.createElement("option",{value:"city"},"City"),r.a.createElement("option",{value:"province"},"Province"),r.a.createElement("option",{value:"country"},"Country"),r.a.createElement("option",{value:"postalcode"},"Postal Code")),r.a.createElement("input",{type:"text",value:b,placeholder:i?"Enter ".concat(i,"..."):"Enter location...",onChange:function(e){return y(e.currentTarget.value)}}),r.a.createElement("button",{type:"submit"},"Search Restaurants")),x&&r.a.createElement("button",{onClick:function(){return S.apply(this,arguments)}},"View All Restaurants"))};var j=function(e){var t=e.rating,a=e.count,c=Object(n.useState)(),l=Object(o.a)(c,2),u=l[0],s=l[1];return Object(n.useEffect)((function(){for(var e=[],a=parseFloat(t),n=1;n<=5;n++)n<=a?e.push(r.a.createElement("i",{key:n,className:"fa fa-star","aria-hidden":"true"})):n-.5<=a?e.push(r.a.createElement("i",{key:n,className:"fa fa-star-half-o","aria-hidden":"true"})):e.push(r.a.createElement("i",{key:n,className:"fa fa-star-o","aria-hidden":"true"}));s(e)}),[t]),r.a.createElement(r.a.Fragment,null,u," ",a?"(".concat(a,")"):"")},O=a(15),x=Object(n.createContext)();function w(e){var t=r.a.createRef(),a=document.createElement("div");return Object(n.useEffect)((function(){l.a.render(r.a.Children.only(e.children),a),t.current.infowindow.setContent(a)}),[e.children]),r.a.createElement(O.InfoWindow,Object.assign({ref:t},e))}var C=Object(O.GoogleApiWrapper)({apiKey:"https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=geometry,drawing,places&key=".concat("AIzaSyCcbP47PnbbLWJ4T9GdciB5LCrFSSIP-EA")})((function(e){var t=Object(n.useContext)(x),a=t.restaurantCollection,c=t.sortCount,l=Object(n.useState)([]),u=Object(o.a)(l,2),s=u[0],m=u[1],g=Object(n.useState)(null),h=Object(o.a)(g,2),b=h[0],E=h[1],y=Object(n.useState)(0),j=Object(o.a)(y,2),C=(j[0],j[1]),k=Object(i.f)(),S=Object(n.useContext)(p),F=Object(n.useState)(0),R=Object(o.a)(F,2),M=R[0],I=R[1],P=Object(n.useState)({length:a.length,firstItem:a[0]}),L=Object(o.a)(P,2),N=L[0],T=L[1],A=Object(n.useState)(c),q=Object(o.a)(A,2),D=q[0],z=q[1];function B(){return(B=Object(f.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("/api/restaurants/".concat(t.id));case 3:a=e.sent,E(a.data),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),E(t),S({type:"FlashMessage",value:"Error retrieving restaurant image.",color:"error"});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}return Object(n.useEffect)((function(){m(a.map((function(e){var t=parseFloat(e.latitude),a=parseFloat(e.longtitude);return r.a.createElement(O.Marker,{key:e.id,position:{lat:t,lng:a},onClick:function(){!function(e){B.apply(this,arguments)}(e)}})})))}),[M]),Object(n.useEffect)((function(){C((function(e){return e+1}))}),[b]),Object(n.useEffect)((function(){(a.length!==N.length||a[0]!==N.firstItem&&c===D)&&(E(null),I((function(e){return e+1})),T({length:a.length,firstItem:a[0]})),z(c)}),[a]),r.a.createElement(r.a.Fragment,null,r.a.createElement(O.Map,{google:e.google,zoom:a.length>2?9:11,key:M,initialCenter:a.length?{lat:parseFloat(a[0].latitude),lng:parseFloat(a[0].longtitude)}:{lat:43.6532,lng:-79.3832},style:{width:"100%",height:"100%"},containerStyle:{position:"relative",height:"70vh",width:"100%"}},s,b&&r.a.createElement(w,{onClose:function(){return E(null)},position:{lat:parseFloat(b.latitude),lng:parseFloat(b.longtitude)},visible:!0},r.a.createElement("div",null,b.images[0]&&r.a.createElement("div",null,r.a.createElement("div",{style:{width:"50px",height:"50px"}},r.a.createElement("img",{style:{width:"50px",height:"50px"},src:b.images[0].url_location}))),r.a.createElement("h3",null,b.name),r.a.createElement("button",{type:"button",onClick:function(){return e=b.id,void k.push("/restaurant/".concat(e));var e}},"View Details")))))}));var k=function(e){var t=Object(n.useState)(!0),a=Object(o.a)(t,2),c=a[0],l=a[1],u=Object(n.useState)([]),i=Object(o.a)(u,2),g=i[0],b=i[1],E=Object(n.useState)([]),O=Object(o.a)(E,2),w=O[0],k=O[1],S=Object(n.useState)(10),F=Object(o.a)(S,2),R=F[0],M=F[1],I=Object(n.useState)(0),P=Object(o.a)(I,2),L=P[0],N=P[1],T=Object(n.useContext)(p),A=Object(n.useContext)(m);function q(){return(q=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete this post?")){e.next=13;break}return e.prev=2,e.next=5,v.a.delete("/api/restaurants/".concat(t));case 5:k((function(e){return e.filter((function(e){return e.id!==t}))})),b((function(e){return e.filter((function(e){return e.id!==t}))})),T({type:"FlashMessage",value:"Restaurant was successfully deleted!",color:"success"}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),T({type:"FlashMessage",value:e.t0.response.data,color:"error"});case 13:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}Object(n.useEffect)((function(){function e(){return(e=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("/api/restaurants");case 3:t=e.sent,b(t.data),k(t.data.slice(0,10)),l(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),T({type:"FlashMessage",value:"Server is temporarily down. Please try again later.",color:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var D=Object(n.useCallback)((function(){window.scrollY+window.innerHeight>=document.body.offsetHeight&&M((function(e){return e+10}))}),[]),z=Object(n.useCallback)(h.a(D,200),[]);return Object(n.useEffect)((function(){return window.addEventListener("scroll",z),function(){return window.removeEventListener("scroll",z)}}),[g]),Object(n.useEffect)((function(){k(g.slice(0,R)),g.length&&R>=g.length&&window.removeEventListener("scroll",z)}),[R]),c?r.a.createElement("div",null,"Loading..."):r.a.createElement(r.a.Fragment,null,r.a.createElement(x.Provider,{value:{restaurantCollection:g,sortCount:L}},r.a.createElement(C,null)),r.a.createElement("h1",null,"Restaurants List"),r.a.createElement(y,{setRestaurants:k,setSortCount:N,setRestaurantCollection:b,restaurantCollection:g}),r.a.createElement("div",null,w.map((function(e){for(var t="",a=0;a<e.pricerange;a++)t+="$";return r.a.createElement("div",{key:e.id},r.a.createElement("br",null),r.a.createElement("div",null,"Name: ",e.name),r.a.createElement("div",null,"Description: ",e.description),r.a.createElement("div",null,"Location: ",e.location),r.a.createElement("div",null,"Price Range: ",t),e.rating?r.a.createElement(j,{rating:e.rating,count:e.count}):"No Ratings",r.a.createElement("br",null),r.a.createElement(s.b,{to:"/restaurant/".concat(e.id)},"View Details"),A.loggedIn&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.b,{to:"/restaurant/".concat(e.id,"/update")},"Edit Restaurant"),r.a.createElement("button",{onClick:function(){return function(e){return q.apply(this,arguments)}(e.id)}},"Delete Restaurant")),r.a.createElement("br",null))}))),!w.length&&r.a.createElement("h1",null,"No Results found..."),r.a.createElement("br",null),r.a.createElement("br",null))},S=a(17);var F=function(e){var t=Object(n.useState)(!0),a=Object(o.a)(t,2),c=a[0],l=a[1],s=Object(n.useState)({name:"",description:"",pricerange:"",street:"",city:"",province:"",country:"",postalcode:""}),g=Object(o.a)(s,2),h=g[0],b=g[1],E=Object(n.useState)(),y=Object(o.a)(E,2),j=y[0],O=y[1],x=Object(n.useState)(),w=Object(o.a)(x,2),C=w[0],k=w[1],F=Object(i.f)(),R=Object(n.useContext)(p),M=Object(n.useContext)(m),I=Object(i.g)().id;function P(){return(P=Object(f.a)(d.a.mark((function e(t){var a,n,r,c,l,o,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,a="".concat(h.street," ").concat(h.city," ").concat(h.province," ").concat(h.country),e.next=5,v.a.get("https://maps.googleapis.com/maps/api/geocode/json",{params:{address:a,key:"AIzaSyCcbP47PnbbLWJ4T9GdciB5LCrFSSIP-EA"}});case 5:return n=e.sent,r=n.data.results[0].geometry.location.lat,c=n.data.results[0].geometry.location.lng,e.next=10,v.a.put("/api/restaurants/".concat(I),{name:h.name,description:h.description,priceRange:parseInt(h.pricerange),street:h.street,city:h.city,province:h.province,country:h.country,postalcode:h.postalcode,longtitude:c,latitude:r});case 10:if(l=e.sent,!j){e.next=16;break}for(o=new FormData,u=0;u<j.length;u++)o.append("image",j[u]);return e.next=16,v.a.post("/api/restaurants/upload-image/".concat(l.data.id),o,{headers:{"Content-Type":"multipart/form-data"}});case 16:F.push("/restaurant/".concat(I)),R({type:"FlashMessage",value:"Restaurant was successfully updated!",color:"success"}),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),R({type:"FlashMessage",value:e.t0.response.data,color:"error"});case 23:case"end":return e.stop()}}),e,null,[[1,20]])})))).apply(this,arguments)}function L(e){b(Object(u.a)(Object(u.a)({},h),{},Object(S.a)({},e.currentTarget.name,e.currentTarget.value)))}return Object(n.useEffect)((function(){M.loggedIn||(F.push("/"),R({type:"FlashMessage",value:"You do not have the authorization to view that page.",color:"error"}))}),[M.loggedIn]),Object(n.useEffect)((function(){if(M.loggedIn){function e(){return(e=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("/api/restaurants/".concat(I));case 3:t=e.sent,b(t.data),l(!1),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),R({type:"FlashMessage",value:e.t0.response.data,color:"error"}),F.push("/");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}}),[I]),c?r.a.createElement("div",null,"Loading..."):r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Update Restaurant"),r.a.createElement("form",{onSubmit:function(e){return P.apply(this,arguments)}},r.a.createElement("input",{name:"name",placeholder:"Name",type:"text",value:h.name,onChange:function(e){return L(e)},required:!0}),r.a.createElement("input",{name:"description",placeholder:"Description",type:"text",value:h.description,onChange:function(e){return L(e)},required:!0}),r.a.createElement("input",{name:"pricerange",placeholder:"Price Range",type:"number",value:h.pricerange,onChange:function(e){return L(e)},required:!0,max:"5",min:"1"}),r.a.createElement("input",{name:"street",placeholder:"Street",type:"text",value:h.street,onChange:function(e){return L(e)},required:!0}),r.a.createElement("input",{name:"city",placeholder:"City",type:"text",value:h.city,onChange:function(e){return L(e)},required:!0}),r.a.createElement("input",{name:"province",placeholder:"Province",type:"text",value:h.province,onChange:function(e){return L(e)},required:!0}),r.a.createElement("input",{name:"country",placeholder:"Country",type:"text",value:h.country,onChange:function(e){return L(e)},required:!0}),r.a.createElement("input",{name:"postalcode",placeholder:"Postal Code",type:"text",value:h.postalcode,onChange:function(e){return L(e)},required:!0}),r.a.createElement("input",{type:"file",onChange:function(e){for(var t=[],a=[],n=0,r=e.currentTarget.files.length;n<r;n++){var c=e.currentTarget.files[n];"image/png"!=c.type&&"image/jpeg"!=c.type||(c.size<2097152?(a.push(c),t.push(URL.createObjectURL(c))):R({type:"FlashMessage",value:"".concat(c.name," is too big! Images must be below 2MB"),color:"error"}))}O(a),k(t)},multiple:!0}),r.a.createElement("button",{type:"submit"},"Update Restaurant")),C&&C.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("div",{style:{width:"200px",height:"200px"}},r.a.createElement("img",{style:{width:"200px",height:"200px"},src:e})))})))};var R=function(e){var t=e.review,a=e.ratings,c=e.setRatings,l=e.restaurant,o=e.setRestaurant,s=e.setRatingsCollection,i=Object(n.useContext)(p),g=Object(n.useContext)(m);function h(){return(h=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.delete("/api/ratings/".concat(t.id));case 3:b(),c((function(e){return e.filter((function(e){return e.id!==t.id}))})),s((function(e){return e.filter((function(e){return e.id!==t.id}))})),i({type:"FlashMessage",value:"Review was successfully deleted!",color:"success"}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),i({type:"FlashMessage",value:e.t0.response.data,color:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function b(){var e=0;a.forEach((function(t){e+=parseFloat(t.rating)}));var n=((e-=parseFloat(t.rating))/(a.length-1)).toFixed(1);o(Object(u.a)(Object(u.a)({},l),{},{rating:n,count:l.count-1}))}return r.a.createElement(r.a.Fragment,null,r.a.createElement(j,{rating:t.rating}),r.a.createElement("div",null,t.rating),r.a.createElement("div",null,t.name),r.a.createElement("div",null,t.message),g.loggedIn&&r.a.createElement("button",{type:"submit",onClick:function(){return h.apply(this,arguments)}},"Delete Review"),r.a.createElement("br",null))};var M=function(e){var t=e.id,a=e.setRatings,c=e.ratings,l=e.setRestaurant,s=e.restaurant,i=e.setRatingsCollection,m=Object(n.useState)({restaurant_id:t,rating:"",name:"",message:""}),g=Object(o.a)(m,2),h=g[0],b=g[1],E=Object(n.useContext)(p);function y(e){b(Object(u.a)(Object(u.a)({},h),{},Object(S.a)({},e.currentTarget.name,e.currentTarget.value)))}function j(){return(j=Object(f.a)(d.a.mark((function e(n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),!(h.restaurant_id&&1<=parseFloat(h.rating)<=5&&h.name&&h.message)){e.next=18;break}return e.prev=2,e.next=5,v.a.post("/api/ratings/",{restaurant_id:h.restaurant_id,rating:parseFloat(h.rating),name:h.name,message:h.message});case 5:r=e.sent,O(h.rating),a((function(e){return[r.data].concat(e)})),i((function(e){return[r.data].concat(e)})),b({restaurant_id:t,rating:"",name:"",message:""}),E({type:"FlashMessage",value:"Review was successfully published!",color:"success"}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),E({type:"FlashMessage",value:e.t0.response.data,color:"error"});case 16:e.next=19;break;case 18:E({type:"FlashMessage",value:"You cannot leave the fields blank.",color:"error"});case 19:case"end":return e.stop()}}),e,null,[[2,13]])})))).apply(this,arguments)}function O(e){var t=parseFloat(e);c.forEach((function(e){t+=parseFloat(e.rating)}));var a=(t/(c.length+1)).toFixed(1);l(Object(u.a)(Object(u.a)({},s),{},{rating:a,count:parseInt(s.count)+1}))}return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:function(e){return j.apply(this,arguments)}},r.a.createElement("input",{type:"number",name:"rating",placeholder:"Rating",value:h.rating,onChange:function(e){return y(e)},min:"1",max:"5",step:"0.1"}),r.a.createElement("input",{type:"text",name:"name",placeholder:"Name",value:h.name,onChange:function(e){return y(e)}}),r.a.createElement("input",{type:"text",name:"message",placeholder:"Message",value:h.message,onChange:function(e){return y(e)}}),r.a.createElement("button",{type:"submit"},"Submit Review")))};var I=Object(O.GoogleApiWrapper)({apiKey:"https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=geometry,drawing,places&key=".concat("AIzaSyCcbP47PnbbLWJ4T9GdciB5LCrFSSIP-EA")})((function(e){var t=e.restaurant,a={lat:t.latitude,lng:t.longtitude};return r.a.createElement(r.a.Fragment,null,r.a.createElement(O.Map,{google:e.google,zoom:14,initialCenter:a,style:{width:"100%",height:"100%"},containerStyle:{position:"relative",height:"400px",width:"400px"},disableDefaultUI:!0,zoomControl:!0,streetViewControl:!0},r.a.createElement(O.Marker,{position:a})))}));var P=function(e){var t=Object(n.useState)(!0),a=Object(o.a)(t,2),c=a[0],l=a[1],g=Object(n.useState)(),h=Object(o.a)(g,2),b=h[0],E=h[1],y=Object(n.useState)([]),O=Object(o.a)(y,2),x=O[0],w=O[1],C=Object(n.useState)([]),k=Object(o.a)(C,2),S=k[0],F=k[1],P=Object(n.useState)(5),L=Object(o.a)(P,2),N=L[0],T=L[1],A=Object(n.useState)(!1),q=Object(o.a)(A,2),D=q[0],z=q[1],B=Object(n.useState)(0),U=Object(o.a)(B,2),W=U[0],H=U[1],Y=Object(n.useState)(0),_=Object(o.a)(Y,2),G=_[0],J=_[1],V=Object(i.f)(),K=Object(i.g)().id,Z=Object(n.useContext)(p),$=Object(n.useContext)(m);function Q(){return(Q=Object(f.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.delete("/api/restaurants/delete-image/".concat(t));case 3:a=b.images.filter((function(e){return e.id!==t})),E(Object(u.a)(Object(u.a)({},b),{},{images:a})),Z({type:"FlashMessage",value:"Image deleted successfully!",color:"success"}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),Z({type:"FlashMessage",value:e.t0.response.data,color:"error"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function X(){return(X=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete this restaurant?")){e.next=12;break}return e.prev=2,e.next=5,v.a.delete("/api/restaurants/".concat(t));case 5:Z({type:"FlashMessage",value:"Restaurant was successfully deleted!",color:"success"}),V.push("/"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),Z({type:"FlashMessage",value:e.t0.response.data,color:"error"});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}return Object(n.useEffect)((function(){function e(){return(e=Object(f.a)(d.a.mark((function e(){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("/api/restaurants/".concat(K));case 3:a=e.sent,E(a.data),t(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),Z({type:"FlashMessage",value:"A restaurant with that id does not exist",color:"error"}),V.push("/");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function t(){return a.apply(this,arguments)}function a(){return(a=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("/api/ratings/".concat(K));case 3:t=e.sent,F(t.data),w(t.data.slice(0,N)),t.data.length>5&&z(!0),l(!1),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),Z({type:"FlashMessage",value:e.t0.response.data,color:"error"});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[K]),Object(n.useEffect)((function(){H(window.scrollY),w(S.slice(0,N)),J((function(e){return e+1})),S.length&&N>=S.length&&z(!1)}),[N]),Object(n.useEffect)((function(){window.scrollTo(0,W)}),[G]),c?r.a.createElement("div",null,"Loading..."):r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,b.name),$.loggedIn&&r.a.createElement(s.b,{to:"/restaurant/".concat(b.id,"/update")},"Add Photo(s)"),r.a.createElement("br",null),r.a.createElement("br",null),b.images&&b.images.map((function(e){return r.a.createElement("div",{key:e.id},$.loggedIn&&r.a.createElement("button",{onClick:function(){return function(e){return Q.apply(this,arguments)}(e.id)}},"delete image by clicking this button!"),r.a.createElement("div",{style:{width:"200px",height:"200px"}},r.a.createElement("img",{style:{width:"200px",height:"200px"},src:e.url_location})))})),r.a.createElement(I,{restaurant:b}),r.a.createElement("h3",null,"Page Details"),r.a.createElement("div",null,"name: ",b.name),r.a.createElement("div",null,"description: ",b.description),r.a.createElement("div",null,"location: ",b.location),r.a.createElement("div",null,"pricerange: ",b.pricerange),b.rating>0?r.a.createElement(j,{rating:b.rating,count:b.count}):"No Ratings",r.a.createElement("div",null,"rating: ",b.rating),r.a.createElement("div",null,"count: ",b.count),$.loggedIn&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.b,{to:"/restaurant/".concat(b.id,"/update")},"Edit Restaurant"),r.a.createElement("button",{onClick:function(){return function(e){return X.apply(this,arguments)}(b.id)}},"Delete Restaurant")),r.a.createElement("br",null),r.a.createElement(M,{id:K,setRatings:w,ratings:x,setRestaurant:E,restaurant:b,setRatingsCollection:F}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",null,x.map((function(e){return r.a.createElement(R,{key:e.id,review:e,setRatings:w,ratings:x,setRestaurant:E,restaurant:b,setRatingsCollection:F})}))),D&&r.a.createElement("button",{onClick:function(){return T((function(e){return e+5}))}},"Load More Ratings"))};var L=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"404 Error"),r.a.createElement("div",null,"Page not found"),r.a.createElement(s.b,{to:"/"},"Return Home"))};function N(e){return r.a.createElement("li",null,r.a.createElement(s.b,{to:"/restaurant/".concat(e.id),onClick:function(){return e.setSearchResults(!1)}},r.a.createElement("div",null,e.name)))}var T=function(e){var t,a=Object(n.useState)(""),c=Object(o.a)(a,2),l=c[0],u=c[1],s=Object(n.useState)([]),i=Object(o.a)(s,2),m=i[0],g=i[1],h=Object(n.useState)(!1),b=Object(o.a)(h,2),E=b[0],y=b[1],j=Object(n.useContext)(p),O=function(){var e=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("/api/query/".concat(l));case 3:(t=e.sent).data.length?g(t.data):g([]),y(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),j({type:"FlashMessage",value:e.t0.response.data,color:"error"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){return l.length?(y(!0),t=setTimeout(O,300)):(y(!1),g([])),function(){return clearTimeout(t)}}),[l]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,E&&r.a.createElement("h3",null,"Loading...")),r.a.createElement("input",{type:"text",placeholder:"Search for restaurant...",value:l,onChange:function(e){return u(e.currentTarget.value)}}),m.length>0&&r.a.createElement("ul",null,m.map((function(e){return r.a.createElement(N,Object.assign({key:e.id},e,{setSearchResults:g}))}))))};var A=function(e){var t=Object(n.useContext)(p),a=Object(n.useContext)(m);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"navbar"},r.a.createElement("ul",{className:"nav-list"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(s.b,{to:"/",className:"nav-link"},"Home")),a.loggedIn&&r.a.createElement("li",{className:"nav-item"},r.a.createElement(s.b,{to:"/restaurant/create",className:"nav-link"},"Create Restaurant")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{className:"nav-link",onClick:function(){a.loggedIn?t({type:"Logout"}):t({type:"Login"})}},a.loggedIn?"Switch to User":"Switch to Admin"))),r.a.createElement(T,null)))};var q=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"footer"},r.a.createElement("p",{className:"footer-text"},"Yelp Clone Web App")))};var D=function(e){var t=e.state;return r.a.createElement("div",{className:"flash-message-container"},t.flashMessages.length>0&&t.flashMessages.map((function(e,t){return r.a.createElement("div",{key:t,className:"alert "+e.color,onAnimationEnd:function(e){return function(e){e.currentTarget.style.display="none"}(e)}},r.a.createElement("div",{className:"flashMessage"},e.message))})))};var z=function(e){var t=Object(n.useState)({name:"",description:"",pricerange:"",street:"",city:"",province:"",country:"",postalcode:""}),a=Object(o.a)(t,2),c=a[0],l=a[1],s=Object(n.useState)(),g=Object(o.a)(s,2),h=g[0],b=g[1],E=Object(n.useState)(),y=Object(o.a)(E,2),j=y[0],O=y[1],x=Object(i.f)(),w=Object(n.useContext)(p),C=Object(n.useContext)(m);function k(){return(k=Object(f.a)(d.a.mark((function e(t){var a,n,r,l,o,u,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,a="".concat(c.street," ").concat(c.city," ").concat(c.province," ").concat(c.country),e.next=5,v.a.get("https://maps.googleapis.com/maps/api/geocode/json",{params:{address:a,key:"AIzaSyCcbP47PnbbLWJ4T9GdciB5LCrFSSIP-EA"}});case 5:return n=e.sent,r=n.data.results[0].geometry.location.lat,l=n.data.results[0].geometry.location.lng,e.next=10,v.a.post("/api/restaurants",{name:c.name,description:c.description,priceRange:parseInt(c.pricerange),street:c.street,city:c.city,province:c.province,country:c.country,postalcode:c.postalcode,longtitude:l,latitude:r});case 10:if(o=e.sent,!h){e.next=16;break}for(u=new FormData,s=0;s<h.length;s++)u.append("image",h[s]);return e.next=16,v.a.post("/api/restaurants/upload-image/".concat(o.data.id),u,{headers:{"Content-Type":"multipart/form-data"}});case 16:w({type:"FlashMessage",value:"Restaurant was successfully created!",color:"success"}),x.push("/restaurant/".concat(o.data.id)),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),w({type:"FlashMessage",value:e.t0.response.data,color:"error"});case 23:case"end":return e.stop()}}),e,null,[[1,20]])})))).apply(this,arguments)}function F(e){l(Object(u.a)(Object(u.a)({},c),{},Object(S.a)({},e.currentTarget.name,e.currentTarget.value)))}return Object(n.useEffect)((function(){C.loggedIn||(w({type:"FlashMessage",value:"You do not have the authorization to view that page.",color:"error"}),x.push("/"))}),[C.loggedIn]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Create New Restaurant"),r.a.createElement("form",{onSubmit:function(e){return k.apply(this,arguments)}},r.a.createElement("input",{name:"name",placeholder:"Name",type:"text",value:c.name,onChange:function(e){return F(e)},required:!0}),r.a.createElement("input",{name:"description",placeholder:"Description",type:"text",value:c.description,onChange:function(e){return F(e)},required:!0}),r.a.createElement("input",{name:"pricerange",placeholder:"Price Range",type:"number",value:c.pricerange,onChange:function(e){return F(e)},required:!0,max:"5",min:"1"}),r.a.createElement("input",{name:"street",placeholder:"Street",type:"text",value:c.street,onChange:function(e){return F(e)},required:!0}),r.a.createElement("input",{name:"city",placeholder:"City",type:"text",value:c.city,onChange:function(e){return F(e)},required:!0}),r.a.createElement("input",{name:"province",placeholder:"Province",type:"text",value:c.province,onChange:function(e){return F(e)},required:!0}),r.a.createElement("input",{name:"country",placeholder:"Country",type:"text",value:c.country,onChange:function(e){return F(e)},required:!0}),r.a.createElement("input",{name:"postalcode",placeholder:"Postal Code",type:"text",value:c.postalcode,onChange:function(e){return F(e)},required:!0}),r.a.createElement("input",{type:"file",onChange:function(e){for(var t=[],a=[],n=0,r=e.currentTarget.files.length;n<r;n++){var c=e.currentTarget.files[n];"image/png"!=c.type&&"image/jpeg"!=c.type||(c.size<2097152?(a.push(c),t.push(URL.createObjectURL(c))):w({type:"FlashMessage",value:"".concat(c.name," is too big! Images must be below 2MB"),color:"error"}))}b(a),O(t)},multiple:!0}),r.a.createElement("button",{type:"submit"},"Create New Restaurant")),j&&j.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("div",{style:{width:"200px",height:"200px"}},r.a.createElement("img",{style:{width:"200px",height:"200px"},src:e})))})))};var B=function(){var e={flashMessages:[],loggedIn:Boolean(localStorage.getItem("yelp-admin"))},t=Object(n.useReducer)((function(e,t){switch(t.type){case"FlashMessage":return Object(u.a)(Object(u.a)({},e),{},{flashMessages:e.flashMessages.concat({message:t.value,color:t.color})});case"Login":return localStorage.setItem("yelp-admin",!0),Object(u.a)(Object(u.a)({},e),{},{loggedIn:!0});case"Logout":return localStorage.removeItem("yelp-admin"),Object(u.a)(Object(u.a)({},e),{},{loggedIn:!1})}}),e),a=Object(o.a)(t,2),c=a[0],l=a[1];return r.a.createElement(p.Provider,{value:l},r.a.createElement(m.Provider,{value:c},r.a.createElement(s.a,null,r.a.createElement(A,null),r.a.createElement(D,{state:c}),r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/",exact:!0},r.a.createElement(k,null)),r.a.createElement(i.a,{path:"/restaurant/create"},r.a.createElement(z,null)),r.a.createElement(i.a,{path:"/restaurant/:id",exact:!0},r.a.createElement(P,null)),r.a.createElement(i.a,{path:"/restaurant/:id/update"},r.a.createElement(F,null)),r.a.createElement(i.a,{path:"*"},r.a.createElement(L,null))),r.a.createElement(q,null))))};l.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(B,null)),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.dae98451.chunk.js.map